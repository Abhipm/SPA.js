spa.component("gitLabProjects",{target:"#containerPrjList"}),spa.extendComponent("gitLabProjects",{renderCallback:function(){"use strict";var e=$("#container_gitLabProjects").find('.card[data-pid="'+app.activeGitLab.pid+'"]');e.length&&e[0].click()},selectProject:function(e,a,t){var i=$("#container_gitLabProjects").find('.card[data-pid="'+e+'"]');$("#container_gitLabProjects").find(".card[data-pid]").removeClass("selected"),i.length&&i.find("i.world.icon").addClass("loading"),app.storage.updateDefaultConnectionSettings({pid:e,web:a,pName:t}),app.activeGitLab.pid=e,app.activeGitLab.web=a,app.activeGitLab.pName=t,app.header.updateActiveProj(),app.gitLabProjects.syncProjComponents()},syncProjComponents:function(){var e=$("#container_gitLabProjects").find('.card[data-pid="'+app.activeGitLab.pid+'"]');app.uiHelper.indicateLoading("#btnRefreshPrjComponents","add"),$.when(app.gitLabProjects.milestonesList(),app.gitLabProjects.membersList(),app.gitLabProjects.labelsList()).done(function(){e.find("i.world.icon").removeClass("loading"),e.addClass("selected"),app.uiHelper.indicateLoading("#btnRefreshPrjComponents","remove")})},milestonesList:function(){return app.uiHelper.indicateLoading("#btnRefreshPrjMilestones","add"),spa.api.get(spa.api.url("@gitLabProjMilestones",{pid:app.activeGitLab.pid}),function(e){var a={};spa.isBlank(e)||_.each(e,function(e){a[e.id]=e.title}),app.storage.updateDefaultConnectionSettings({milestones:e,milestonesDD:a}),app.uiHelper.indicateLoading("#btnRefreshPrjMilestones","remove"),spa.renderComponent("gitLabMilestones",{data:{milestones:_.orderBy(e,["title"],["asc"])}})})},membersList:function(){return app.uiHelper.indicateLoading("#btnRefreshPrjMembers","add"),spa.api.get(spa.api.url("@gitLabProjectMembers",{pid:app.activeGitLab.pid}),function(e){var a={};spa.isBlank(e)||_.each(e,function(e){a[e.id]=((e.name.containsStr(",")?e.name.split(",")[1]:e.name).trimStr().split(" ")[0]||e.username).toProperCase()}),app.storage.updateDefaultConnectionSettings({members:e,membersDD:a}),app.uiHelper.indicateLoading("#btnRefreshPrjMembers","remove"),spa.renderComponent("gitLabMembers",{data:{members:_.orderBy(e,["name"],["asc"])}})})},labelsList:function(){return app.uiHelper.indicateLoading("#btnRefreshPrjLabels","add"),spa.api.get(spa.api.url("@gitLabProjLabels",{pid:app.activeGitLab.pid}),function(e){var a={},t={};spa.isBlank(e)||_.each(e,function(e){a[e.name]=e.name,t[e.name]=e.color}),app.storage.updateDefaultConnectionSettings({labels:e,labelsDD:a,labelsColor:t}),app.uiHelper.indicateLoading("#btnRefreshPrjLabels","remove"),spa.renderComponent("gitLabLabels",{data:{labels:e}})})}});
spa.component("settings",{target:"#mainContent"}),spa.extendComponent("settings",{renderCallback:function(){"use strict";app.header.activate("settings");var e=_.merge({},app.storage.getConnectionDetails());spa.isBlank(e)||(e.key=e.key?sjcl.decrypt(sjcl.decrypt(appStorage.lastSignIn,app.user._),e.key):"",spa.dataBind("#containerPrimaySettings",e),app.settings.listProjects(),app.settings.showProfile())},save:function(e){var t=!1;if(spa.isBlank(spa.validate("#fm_Settings",!0))){var a=spa.serializeFormToSimpleJSON("#fm_Settings"),n=appStorage[app.user.storeName];n.hasOwnProperty("connections")||(n.connections={}),n.defaultConnection=a.conName,n.connections[a.conName]={url:a.url,key:sjcl.encrypt(sjcl.decrypt(appStorage.lastSignIn,app.user._),a.key)},app.init.updateAppStorage(),app.activeGitLab.apiUrl=a.url,app.activeGitLab.pKey=a.key,app.uiHelper.flyout("Sucess","msg.flyout.saveSettingsPrimary"),t=!0,app.settings.showProfile(),e||app.settings.listProjects()}return t},listProjects:function(){app.uiHelper.indicateLoading("#btnFetchProjects","add"),spa.api.get("@gitLabProjects",function(e){app.uiHelper.indicateLoading("#btnFetchProjects","remove"),spa.renderComponent("gitLabProjects",{data:{projects:e}})})},showProfile:function(){app.uiHelper.indicateLoading("#btnSaveVerifyConnection","add"),spa.api.get("@gitLabProfile",function(e){app.uiHelper.indicateLoading("#btnSaveVerifyConnection","remove"),spa.renderComponent("gitLabProfile",{data:e})})},fetchPrj:function(){app.settings.save(!0)?app.settings.listProjects():app.uiHelper.flyout("Warning","msg.flyout.saveSettingsPrimary.failed")}});